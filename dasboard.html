<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard KPI</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        .chart-container {
            min-height: 350px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 6px;
            font-size: 14px;
        }
        .legend-color {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            margin-right: 6px;
        }
    </style>
</head>
<body class="bg-light">

<div class="container py-4">
    <h3 class="fw-bold text-primary mb-4">Dashboard Tiến độ KPI</h3>

    <div class="row g-4">
        <div class="col-lg-6">
            <div class="card shadow-sm">
                <div class="card-header bg-white fw-semibold">Phân bố trạng thái công việc</div>
                <div class="card-body chart-container">
                    <canvas id="barChart"></canvas>
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="card shadow-sm">
                <div class="card-header bg-white fw-semibold">Tỉ lệ % theo trạng thái</div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-7">
                            <canvas id="pieChart"></canvas>
                        </div>
                        <div class="col-5 d-flex flex-column justify-content-center">
                            <div id="legendList"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    // data
    const labels = [
        "Chưa thực hiện",
        "Đang thực hiện",
        "Hoàn thành",
        "Chờ phối hợp",
        "Không áp dụng"
    ];

    const dataValues = [10, 25, 40, 15, 10];
    const colors = ["#6c757d", "#0d6efd", "#198754", "#ffc107", "#dc3545"];

    new Chart(document.getElementById("barChart"), {
        type: "bar",
        data: {
            labels: labels,
            datasets: [{
                label: "Số lượng công việc",
                data: dataValues,
                backgroundColor: colors
            }]
        },
        options: {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false }
            },
            scales: {
                x: { beginAtZero: true }
            }
        }
    });

    const pieChart = new Chart(document.getElementById("pieChart"), {
        type: "pie",
        data: {
            labels: labels,
            datasets: [{
                data: dataValues,
                backgroundColor: colors
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: false }
            }
        }
    });

    const total = dataValues.reduce((sum, val) => sum + val, 0);
    const legendContainer = document.getElementById("legendList");

    labels.forEach((label, i) => {
        const percent = ((dataValues[i] / total) * 100).toFixed(1);
        legendContainer.innerHTML += `
            <div class="legend-item">
                <div class="legend-color" style="background:${colors[i]}"></div>
                ${label}: <strong>${percent}%</strong>
            </div>
        `;
    });
</script>

</body>
</html>
